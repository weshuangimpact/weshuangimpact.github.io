<script>
document.addEventListener('DOMContentLoaded', function() {
    document.body.style.display = 'block';

    const userRole = sessionStorage.getItem('currentUserRole');
    const userName = sessionStorage.getItem('currentUserName');

    let roleTitle = '使用者';
    if (userRole === 'admin') roleTitle = '系統管理員';
    if (userRole === 'medical') roleTitle = '醫護人員';
    if (userRole === 'general') roleTitle = '文管人員';

    document.getElementById('user-display').innerHTML = `${roleTitle} <b>${userName}</b>`;

    /* === admin 只允許 index1,2,3,7,6 === */
    const adminAllow = ['card-index1','card-index2','card-index3','card-index6','card-index7'];

    if (userRole === 'admin') {
        document.querySelectorAll('[id^="card-index"]').forEach(el => {
            if (!adminAllow.includes(el.id)) {
                el.remove();
            }
        });
        return;
    }

    /* === 其他角色原本邏輯 === */
    const cards = {
        manager: document.getElementById('card-index2'),
        eval: document.getElementById('card-index3'),
        maint: document.getElementById('card-index6'),
        master: document.getElementById('card-index7'),
        agent: document.getElementById('card-index8')
    };

    if(cards.maint) cards.maint.style.display = 'none';
    if(cards.master) cards.master.style.display = 'none';
    if(cards.agent) cards.agent.style.display = 'none';

    if (userRole === 'general') {
        if(cards.manager) cards.manager.style.display = 'none';
        if(cards.eval) cards.eval.style.display = 'none';
        if(cards.master) cards.master.style.display = 'block';
    }
});
</script>
