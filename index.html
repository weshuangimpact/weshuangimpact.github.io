<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>職業安全衛生評鑑資料管理系統（完整展示版）</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #f8fafc; }
        
        /* Tab 樣式 */
        .tab-active { border-bottom: 3px solid #0ea5e9; color: #0284c7; font-weight: 700; background-color: white; }
        .tab-inactive { color: #64748b; font-weight: 500; background-color: #f1f5f9; }
        .tab-inactive:hover { background-color: #e2e8f0; color: #334155; }
        
        /* 時間軸樣式 */
        .timeline-item::before {
            content: '';
            position: absolute;
            left: -6px;
            top: 6px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background-color: #cbd5e1;
            border: 2px solid white;
        }
        .timeline-item.active::before {
            background-color: #0ea5e9;
        }

        /* Checkbox 優化 */
        .custom-checkbox:checked {
            background-color: #2563eb;
            border-color: #2563eb;
        }

        /* 動畫 */
        .fade-in-section {
            animation: fadeIn 0.5s ease-out forwards;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* 唯讀與編輯模式切換樣式 */
        .input-readonly {
            background-color: #f8fafc; /* Slate-50 */
            color: #475569; /* Slate-600 */
            cursor: default;
            border-color: #cbd5e1; /* Slate-300 */
            border-style: solid;
        }
        .input-readonly:focus {
            outline: none;
            box-shadow: none;
            border-color: #cbd5e1;
        }
        
        .input-editable {
            background-color: #ffffff;
            color: #1e293b; /* Slate-800 */
            border-color: #3b82f6; /* Blue-500 */
            box-shadow: 0 0 0 1px #3b82f6;
            transition: all 0.2s;
        }
    </style>
</head>
<body class="flex flex-col h-screen overflow-hidden text-slate-800">

    <!-- Header -->
    <header class="bg-slate-900 text-white shadow-md z-20 shrink-0">
        <div class="container mx-auto px-6 py-3 flex justify-between items-center">
            <div class="flex items-center space-x-3">
                <i class="fa-solid fa-shield-halved text-2xl text-blue-400"></i>
                <div>
                    <h1 class="text-lg font-bold tracking-wider">職業安全衛生評鑑資料管理系統</h1>
                    <p class="text-[10px] text-slate-400 uppercase tracking-widest">OSH Evaluation Data Management System (Demo)</p>
                </div>
            </div>
            <div class="text-xs bg-slate-800 px-3 py-1 rounded border border-slate-700">
                <i class="fa-solid fa-user-circle mr-1"></i> 目前使用者：系統管理員
            </div>
        </div>
    </header>

    <!-- Tabs -->
    <nav class="bg-white border-b border-slate-200 shrink-0">
        <div class="container mx-auto px-6 flex space-x-1">
            <button onclick="switchTab('tab1')" id="btn-tab1" class="tab-active px-6 py-3 text-sm transition-colors border-t border-l border-r border-slate-200 rounded-t-lg mt-2 relative top-[1px]">
                <i class="fa-solid fa-magnifying-glass-chart mr-2"></i>評鑑機器人 (查詢)
            </button>
            <button onclick="switchTab('tab2')" id="btn-tab2" class="tab-inactive px-6 py-3 text-sm transition-colors border-t border-l border-r border-transparent rounded-t-lg mt-2">
                <i class="fa-solid fa-file-arrow-up mr-2"></i>顧問資料上傳
            </button>
            <button onclick="switchTab('tab3')" id="btn-tab3" class="tab-inactive px-6 py-3 text-sm transition-colors border-t border-l border-r border-transparent rounded-t-lg mt-2">
                <i class="fa-solid fa-list-check mr-2"></i>管理者完成度總覽
            </button>
            <button onclick="switchTab('tab4')" id="btn-tab4" class="tab-inactive px-6 py-3 text-sm transition-colors border-t border-l border-r border-transparent rounded-t-lg mt-2">
                <i class="fa-solid fa-robot mr-2"></i>文管機器人 (分類Demo)
            </button>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="flex-grow overflow-auto p-6 container mx-auto max-w-7xl relative">

        <!-- ========================================== -->
        <!-- Tab 1: 評鑑機器人 (查詢介面) -->
        <!-- ========================================== -->
        <div id="tab1" class="h-full flex flex-col">
            <!-- 搜尋狀態 -->
            <div id="search-view" class="flex flex-col items-center justify-center h-full transition-all duration-500">
                <div class="w-full max-w-2xl text-center space-y-6">
                    <div class="bg-blue-50 p-4 rounded-full inline-block mb-2">
                        <i class="fa-solid fa-robot text-4xl text-blue-600"></i>
                    </div>
                    <h2 class="text-2xl font-bold text-slate-700">評鑑資料查詢助手</h2>
                    <p class="text-slate-500 text-sm">請輸入關鍵字以調閱評鑑佐證資料。系統僅進行彙整，不進行自動決策。</p>
                    <div class="relative group">
                        <div class="absolute inset-y-0 left-0 flex items-center pl-4 pointer-events-none">
                            <i class="fa-solid fa-search text-slate-400 group-hover:text-blue-500 transition-colors"></i>
                        </div>
                        <input type="text" id="search-input" 
                            class="block w-full p-4 pl-12 text-sm text-slate-900 border border-slate-300 rounded-lg bg-white shadow-sm focus:ring-2 focus:ring-blue-500 transition-all" 
                            placeholder="請輸入查詢指令"
                            value="ABCDEF有限公司 2024 年臨場健康服務評鑑資料">
                        <button onclick="performSearch()" class="absolute right-2.5 bottom-2.5 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg text-sm px-4 py-2 shadow transition-all">
                            查詢調閱
                        </button>
                    </div>
                    <div class="flex justify-center space-x-4 text-xs text-slate-400">
                        <span><i class="fa-solid fa-clock-rotate-left mr-1"></i> 最近查詢：台積電 113年</span>
                        <span><i class="fa-solid fa-building mr-1"></i> 查詢分類：臨場服務</span>
                    </div>
                </div>
            </div>

            <!-- 報告介面 -->
            <div id="report-view" class="hidden pb-12">
                <div class="flex justify-between items-center mb-6">
                    <button onclick="resetSearch()" class="text-slate-500 hover:text-blue-600 text-sm flex items-center">
                        <i class="fa-solid fa-arrow-left mr-2"></i> 返回重新查詢
                    </button>
                    <span class="bg-emerald-100 text-emerald-800 text-xs font-bold px-3 py-1 rounded-full border border-emerald-200">
                        <i class="fa-solid fa-check-circle mr-1"></i> 查詢完成
                    </span>
                </div>

                <div class="bg-white rounded-xl shadow-lg border border-slate-200 overflow-hidden">
                    <div class="bg-slate-50 px-8 py-6 border-b border-slate-200 flex justify-between items-start">
                        <div>
                            <h2 class="text-2xl font-bold text-slate-800 mb-1">臨場健康服務執行績效與評鑑報告</h2>
                            <p class="text-sm text-slate-500">資料來源：系統歸檔資料庫 | 報告產出時間：2026/01/23</p>
                        </div>
                        <button class="text-slate-400 hover:text-slate-600 border border-slate-300 rounded px-3 py-1 text-sm bg-white">
                            <i class="fa-solid fa-print mr-2"></i>列印報告
                        </button>
                    </div>

                    <div class="p-8 grid grid-cols-1 lg:grid-cols-3 gap-8">
                        <div class="lg:col-span-2 space-y-8">
                            <!-- 案件基本資訊 -->
                            <div class="bg-white">
                                <h3 class="text-md font-bold text-blue-800 border-l-4 border-blue-600 pl-3 mb-4">案件基本資訊</h3>
                                <div class="grid grid-cols-2 gap-4 bg-slate-50 p-4 rounded-lg border border-slate-100 text-sm">
                                    <div><span class="block text-slate-400 text-xs mb-1">事業單位名稱</span><span class="font-bold text-slate-700 text-lg">ABCDEF有限公司</span></div>
                                    <div><span class="block text-slate-400 text-xs mb-1">統一編號</span><span class="font-bold text-slate-700">12345678</span></div>
                                    <div><span class="block text-slate-400 text-xs mb-1">服務年度</span><span class="font-bold text-slate-700">2024 年度 (民國 113 年)</span></div>
                                    <div><span class="block text-slate-400 text-xs mb-1">顧問／職護人員</span><span class="font-bold text-slate-700"><i class="fa-solid fa-user-nurse mr-1"></i> 李雅婷 護理師</span></div>
                                </div>
                            </div>
                            <!-- 項目列表 (Read Only) -->
                            <div>
                                <h3 class="text-md font-bold text-blue-800 border-l-4 border-blue-600 pl-3 mb-4">臨場健康服務項目狀態</h3>
                                <div class="overflow-hidden border border-slate-200 rounded-lg">
                                    <table class="min-w-full divide-y divide-slate-200">
                                        <thead class="bg-slate-50">
                                            <tr>
                                                <th class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase">法規條號</th>
                                                <th class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase">狀態</th>
                                            </tr>
                                        </thead>
                                        <tbody class="bg-white divide-y divide-slate-200 text-sm">
                                            <tr><td class="px-6 py-3 font-medium">9-1 體格檢查分析</td><td class="px-6 py-3"><span class="bg-emerald-100 text-emerald-800 px-2 py-1 rounded-full text-xs font-bold">已完成</span></td></tr>
                                            <tr><td class="px-6 py-3 font-medium">9-2 適性評估</td><td class="px-6 py-3"><span class="bg-emerald-100 text-emerald-800 px-2 py-1 rounded-full text-xs font-bold">已完成</span></td></tr>
                                            <tr><td class="px-6 py-3 font-medium">9-3 異常追蹤</td><td class="px-6 py-3"><span class="bg-emerald-100 text-emerald-800 px-2 py-1 rounded-full text-xs font-bold">已完成</span></td></tr>
                                            <tr><td class="px-6 py-3 font-medium">11-1 危害辨識</td><td class="px-6 py-3"><span class="bg-emerald-100 text-emerald-800 px-2 py-1 rounded-full text-xs font-bold">已完成</span></td></tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <!-- 右欄：文件 -->
                        <div>
                             <h3 class="text-md font-bold text-blue-800 border-l-4 border-blue-600 pl-3 mb-4">佐證文件調閱</h3>
                             <div class="space-y-3">
                                <div onclick="openPdfModal('2024_勞工健康服務執行紀錄.pdf')" class="group bg-white border border-slate-200 p-3 rounded-lg shadow-sm hover:shadow-md cursor-pointer transition-all flex items-center">
                                    <div class="bg-red-50 p-2 rounded mr-3 text-red-500"><i class="fa-solid fa-file-pdf text-xl"></i></div>
                                    <div>
                                        <div class="text-sm font-bold text-slate-700 group-hover:text-blue-700">2024_勞工健康服務執行紀錄.pdf</div>
                                        <div class="text-xs text-slate-400">已用印歸檔 • 2.4 MB</div>
                                    </div>
                                </div>
                             </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ========================================== -->
        <!-- Tab 2: 顧問資料上傳介面 -->
        <!-- ========================================== -->
        <div id="tab2" class="hidden">
            <div class="max-w-5xl mx-auto bg-white rounded-lg shadow border border-slate-200">
                <div class="p-6 border-b border-slate-200">
                    <h2 class="text-xl font-bold text-slate-800">顧問資料上傳</h2>
                    <p class="text-sm text-slate-500 mt-1">輸入統編與年度，自動帶入歷史執行紀錄資料。</p>
                </div>
                <div class="p-8 space-y-8">
                    
                    <!-- Step 1: 統編與年度輸入 -->
                    <div class="bg-blue-50 p-6 rounded-lg border border-blue-100">
                        <label class="block text-base font-bold text-blue-800 mb-4 border-l-4 border-blue-500 pl-2">Step 1：帶入作業場所資料</label>
                        <div class="flex flex-col md:flex-row gap-4 items-end">
                            <div class="w-full md:w-1/3">
                                <label class="block text-sm font-medium text-slate-700 mb-1">統一編號 <span class="text-red-500">*</span></label>
                                <input type="text" id="input-tax-id" class="w-full border-slate-300 rounded shadow-sm text-sm p-2 border" placeholder="請輸入8碼統編" value="12345678">
                            </div>
                            <div class="w-full md:w-1/3">
                                <label class="block text-sm font-medium text-slate-700 mb-1">服務年度 <span class="text-red-500">*</span></label>
                                <select id="input-year" class="w-full border-slate-300 rounded shadow-sm text-sm p-2 border">
                                    <option value="2025">2025 (114年)</option>
                                    <option value="2024" selected>2024 (113年)</option>
                                </select>
                            </div>
                            <div class="w-full md:w-1/3">
                                <button onclick="fetchCompanyData()" class="w-full bg-blue-600 text-white px-4 py-2 rounded text-sm font-bold shadow hover:bg-blue-700 transition">
                                    <i class="fa-solid fa-magnifying-glass mr-2"></i> 確認並帶入資料
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- 自動帶入資料區 (預設隱藏) -->
                    <div id="company-data-section" class="hidden space-y-8">
                        
                        <!-- 功能列：資料更新 -->
                        <div class="flex justify-between items-center bg-yellow-50 p-3 rounded-md border border-yellow-200 shadow-sm">
                            <div class="text-sm text-slate-700 flex items-center">
                                <i class="fa-solid fa-file-pdf mr-2 text-red-500"></i> 
                                <span>已帶入資料來源：<span class="font-bold underline">ABCDEF有限公司_勞工健康服務執行紀錄_2024-01-01.pdf</span></span>
                            </div>
                            <button id="edit-btn" onclick="toggleEditMode()" class="bg-white border border-slate-300 text-slate-700 hover:text-blue-600 hover:border-blue-400 px-4 py-1.5 rounded text-sm font-bold shadow-sm transition flex items-center">
                                <i class="fa-solid fa-pen-to-square mr-2"></i> 資料更新 (啟用編輯)
                            </button>
                        </div>

                        <!-- 一、作業場所基本資料 -->
                        <div class="border border-slate-200 rounded-lg overflow-hidden">
                            <div class="bg-slate-50 p-4 border-b border-slate-200">
                                <h3 class="font-bold text-slate-700 text-lg">一、作業場所基本資料</h3>
                            </div>
                            <div class="p-6 grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="md:col-span-2 grid grid-cols-2 gap-6">
                                    <div>
                                        <label class="block text-xs font-bold text-slate-500 uppercase mb-1">事業單位名稱</label>
                                        <input type="text" class="w-full input-readonly rounded text-sm p-2.5" value="ABCDEF有限公司" readonly>
                                    </div>
                                    <div>
                                        <label class="block text-xs font-bold text-slate-500 uppercase mb-1">部門名稱</label>
                                        <input type="text" class="w-full input-readonly rounded text-sm p-2.5 data-field" value="台南廠" readonly>
                                    </div>
                                </div>
                                
                                <!-- 人員統計區塊 -->
                                <div class="md:col-span-2 bg-white rounded-lg border border-slate-200 p-0 overflow-hidden">
                                    <div class="bg-slate-100 px-4 py-2 border-b border-slate-200">
                                        <span class="text-sm font-bold text-slate-700">勞工人數統計</span>
                                    </div>
                                    <div class="p-4 grid grid-cols-1 md:grid-cols-2 gap-8">
                                        <!-- 行政人員 -->
                                        <div class="space-y-3">
                                            <div class="flex items-center">
                                                <span class="text-sm font-bold text-slate-700 w-24">行政人員</span>
                                                <div class="flex items-center mr-4">
                                                    <span class="text-sm text-slate-500 mr-2">男</span>
                                                    <input type="number" class="w-20 input-readonly rounded text-sm p-1.5 text-center data-field font-bold" value="30" readonly>
                                                    <span class="text-sm text-slate-500 ml-1">人</span>
                                                </div>
                                                <div class="flex items-center">
                                                    <span class="text-sm text-slate-500 mr-2">女</span>
                                                    <input type="number" class="w-20 input-readonly rounded text-sm p-1.5 text-center data-field font-bold" value="20" readonly>
                                                    <span class="text-sm text-slate-500 ml-1">人</span>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- 作業人員 -->
                                        <div class="space-y-3">
                                            <div class="flex items-center">
                                                <span class="text-sm font-bold text-slate-700 w-24">現場操作人員</span>
                                                <div class="flex items-center mr-4">
                                                    <span class="text-sm text-slate-500 mr-2">男</span>
                                                    <input type="number" class="w-20 input-readonly rounded text-sm p-1.5 text-center data-field font-bold" value="40" readonly>
                                                    <span class="text-sm text-slate-500 ml-1">人</span>
                                                </div>
                                                <div class="flex items-center">
                                                    <span class="text-sm text-slate-500 mr-2">女</span>
                                                    <input type="number" class="w-20 input-readonly rounded text-sm p-1.5 text-center data-field font-bold" value="20" readonly>
                                                    <span class="text-sm text-slate-500 ml-1">人</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- 特別危害健康作業 -->
                                    <div class="bg-slate-50 px-4 py-3 border-t border-slate-200">
                                        <div class="flex flex-wrap items-center gap-4">
                                            <span class="text-sm font-bold text-slate-700"><i class="fa-solid fa-triangle-exclamation text-yellow-500 mr-1"></i> 特別危害健康作業</span>
                                            <div class="flex items-center bg-white border border-slate-300 px-3 py-1 rounded-full">
                                                <span class="text-xs text-slate-500 mr-2">1. 高溫</span>
                                                <input type="number" class="w-12 text-center text-sm font-bold input-readonly data-field p-0 border-none bg-transparent" value="5" readonly>
                                                <span class="text-xs text-slate-500">人</span>
                                            </div>
                                            <div class="flex items-center bg-white border border-slate-300 px-3 py-1 rounded-full">
                                                <span class="text-xs text-slate-500 mr-2">2. 噪音</span>
                                                <input type="number" class="w-12 text-center text-sm font-bold input-readonly data-field p-0 border-none bg-transparent" value="20" readonly>
                                                <span class="text-xs text-slate-500">人</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 二、作業場所與勞動條件概況 -->
                        <div class="border border-slate-200 rounded-lg overflow-hidden">
                            <div class="bg-slate-50 p-4 border-b border-slate-200">
                                <h3 class="font-bold text-slate-700 text-lg">二、作業場所與勞動條件概況</h3>
                            </div>
                            
                            <div class="p-6 space-y-5">
                                <div>
                                    <label class="block text-sm font-bold text-slate-700 mb-1">1. 工作流程 (製程)</label>
                                    <textarea class="w-full input-readonly rounded text-sm p-3 data-field min-h-[60px]" readonly>整經漿紗->織布->脫漿->成布加工->品質檢驗->儲運。</textarea>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-bold text-slate-700 mb-1">2. 工作型態與時間</label>
                                    <textarea class="w-full input-readonly rounded text-sm p-3 data-field min-h-[60px]" readonly>行政人員常日班,產線人員輪值三班。</textarea>
                                </div>

                                <div>
                                    <label class="block text-sm font-bold text-slate-700 mb-1">3. 人員及危害特性概述</label>
                                    <textarea class="w-full input-readonly rounded text-sm p-3 data-field min-h-[80px]" readonly>潛在工作危害特性:高溫、噪音、人因性危害、精密作業、長時間夜間工作、切割捲夾。</textarea>
                                </div>
                            </div>
                        </div>

                        <!-- Step 2 臨場服務項目 -->
                        <div class="bg-white p-6 rounded-lg border border-blue-200 shadow-sm">
                            <label class="block text-base font-bold text-blue-800 mb-4 border-l-4 border-blue-500 pl-2">Step 2：臨場服務項目勾選 (本規則第九條至第十三條事項)</label>
                            
                            <!-- 核心必要紀錄 -->
                            <div class="mb-4 pb-4 border-b border-slate-100">
                                <label class="flex items-center space-x-3 p-3 bg-blue-50 border border-blue-200 rounded-md shadow-sm hover:bg-blue-100 cursor-pointer transition">
                                    <input type="checkbox" class="w-5 h-5 text-blue-600 rounded border-gray-300 focus:ring-blue-500 custom-checkbox" checked>
                                    <span class="font-bold text-blue-900">勞工健康服務執行紀錄表 <span class="text-red-500 text-xs ml-1">(必要)</span></span>
                                </label>
                            </div>

                            <div class="grid grid-cols-1 md:grid-cols-2 gap-3 text-sm">
                                <label class="flex items-start space-x-2 p-2 hover:bg-slate-50 rounded cursor-pointer"><input type="checkbox" class="mt-1 custom-checkbox rounded text-blue-600" checked><span class="text-slate-700">9-1 勞工體格(健康)檢查結果分析與評估。</span></label>
                                <label class="flex items-start space-x-2 p-2 hover:bg-slate-50 rounded cursor-pointer"><input type="checkbox" class="mt-1 custom-checkbox rounded text-blue-600" checked><span class="text-slate-700">9-2 勞工適性工作評估與配置建議。</span></label>
                                <label class="flex items-start space-x-2 p-2 hover:bg-slate-50 rounded cursor-pointer"><input type="checkbox" class="mt-1 custom-checkbox rounded text-blue-600" checked><span class="text-slate-700">9-3 健康檢查異常追蹤與健康指導。</span></label>
                                <label class="flex items-start space-x-2 p-2 hover:bg-slate-50 rounded cursor-pointer"><input type="checkbox" class="mt-1 custom-checkbox rounded text-blue-600" checked><span class="text-slate-700">9-4 特別危害健康作業勞工管理。</span></label>
                                <label class="flex items-start space-x-2 p-2 hover:bg-slate-50 rounded cursor-pointer"><input type="checkbox" class="mt-1 custom-checkbox rounded text-blue-600" checked><span class="text-slate-700">9-5 職業傷病與健康相關資料保存。</span></label>
                                <label class="flex items-start space-x-2 p-2 hover:bg-slate-50 rounded cursor-pointer"><input type="checkbox" class="mt-1 custom-checkbox rounded text-blue-600" checked><span class="text-slate-700">9-6 健康教育、衛生指導與健康促進。</span></label>
                                <label class="flex items-start space-x-2 p-2 hover:bg-slate-50 rounded cursor-pointer"><input type="checkbox" class="mt-1 custom-checkbox rounded text-blue-600" checked><span class="text-slate-700">9-7 工作相關傷病之預防、健康諮詢與急救及緊急處置。</span></label>
                                <label class="flex items-start space-x-2 p-2 hover:bg-slate-50 rounded cursor-pointer"><input type="checkbox" class="mt-1 custom-checkbox rounded text-blue-600" checked><span class="text-slate-700">9-8 定期向雇主報告及勞工健康服務之建議。</span></label>
                                <div class="col-span-full border-t border-slate-100 my-1"></div>
                                <label class="flex items-start space-x-2 p-2 hover:bg-slate-50 rounded cursor-pointer"><input type="checkbox" class="mt-1 custom-checkbox rounded text-blue-600" checked><span class="text-slate-700">11-1 辨識與評估工作場所危害因子。</span></label>
                                <label class="flex items-start space-x-2 p-2 hover:bg-slate-50 rounded cursor-pointer"><input type="checkbox" class="mt-1 custom-checkbox rounded text-blue-600" checked><span class="text-slate-700">11-2 提出作業環境安全衛生設施改善規劃。</span></label>
                                <label class="flex items-start space-x-2 p-2 hover:bg-slate-50 rounded cursor-pointer"><input type="checkbox" class="mt-1 custom-checkbox rounded text-blue-600" checked><span class="text-slate-700">11-3 調查勞工健康情形與作業之關連性。</span></label>
                                <label class="flex items-start space-x-2 p-2 hover:bg-slate-50 rounded cursor-pointer"><input type="checkbox" class="mt-1 custom-checkbox rounded text-blue-600" checked><span class="text-slate-700">11-4 提供復工勞工之職能評估、職務再設計。</span></label>
                                <label class="flex items-start space-x-2 p-2 hover:bg-slate-50 rounded cursor-pointer"><input type="checkbox" class="mt-1 custom-checkbox rounded text-blue-600" checked><span class="text-slate-700">11-5 其他經中央主管機關指定公告者。</span></label>
                                <div class="col-span-full border-t border-slate-100 my-1"></div>
                                <label class="flex items-start space-x-2 p-2 hover:bg-slate-50 rounded cursor-pointer"><input type="checkbox" class="mt-1 custom-checkbox rounded text-blue-600" checked><span class="text-slate-700">12 訂定勞工健康服務計畫。</span></label>
                                <label class="flex items-start space-x-2 p-2 hover:bg-slate-50 rounded cursor-pointer"><input type="checkbox" class="mt-1 custom-checkbox rounded text-blue-600" checked><span class="text-slate-700">13 訂定勞工健康管理方案。</span></label>
                            </div>
                             <div class="mt-4 pt-4 border-t border-slate-200">
                                <label class="flex items-center space-x-3 p-2 hover:bg-slate-50 rounded cursor-pointer text-slate-600">
                                    <input type="checkbox" class="w-4 h-4 text-slate-500 rounded border-gray-300 custom-checkbox">
                                    <span class="text-sm font-medium">其他附件或證明文件</span>
                                </label>
                            </div>
                        </div>

                        <!-- 上傳區 -->
                        <div class="border-2 border-dashed border-slate-300 rounded-lg p-8 text-center bg-slate-50 hover:bg-white transition cursor-pointer">
                            <i class="fa-solid fa-cloud-arrow-up text-3xl text-slate-400 mb-2"></i>
                            <p class="text-sm font-medium text-slate-600">點擊上傳 PDF 文件</p>
                            <p class="text-xs text-slate-400 mt-1">請上傳已用印之正式文件以供評鑑佐證</p>
                        </div>

                        <div class="flex justify-end pt-4 border-t border-slate-100">
                            <button class="bg-blue-600 text-white px-8 py-2.5 rounded text-sm font-bold shadow hover:bg-blue-700 transition">
                                <i class="fa-regular fa-paper-plane mr-2"></i> 確認上傳
                            </button>
                        </div>
                    </div> 
                </div>
            </div>
        </div>

        <!-- ========================================== -->
        <!-- Tab 3: 管理者完成度總覽 -->
        <!-- ========================================== -->
        <div id="tab3" class="hidden">
            <div class="bg-white rounded-lg shadow border border-slate-200 overflow-hidden">
                <div class="p-6 border-b border-slate-200 flex justify-between items-center">
                    <h2 class="text-xl font-bold text-slate-800">各事業單位評鑑資料完成度總覽</h2>
                    <div class="flex space-x-2">
                        <span class="text-xs bg-emerald-100 text-emerald-800 px-2 py-1 rounded">可評鑑: 12</span>
                        <span class="text-xs bg-red-100 text-red-800 px-2 py-1 rounded">未完成: 3</span>
                    </div>
                </div>
                <table class="w-full text-sm text-left">
                    <thead class="bg-slate-50 text-slate-500 font-bold">
                        <tr>
                            <th class="px-6 py-3">事業單位</th>
                            <th class="px-6 py-3">年度</th>
                            <th class="px-6 py-3">已完成項目數</th>
                            <th class="px-6 py-3">缺件項目</th>
                            <th class="px-6 py-3">狀態</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-slate-200">
                        <tr class="hover:bg-slate-50">
                            <td class="px-6 py-4 font-bold text-slate-700">ABCDEF有限公司</td>
                            <td class="px-6 py-4">2024</td>
                            <td class="px-6 py-4">15 / 15</td>
                            <td class="px-6 py-4 text-green-500">無</td>
                            <td class="px-6 py-4"><span class="bg-emerald-100 text-emerald-800 px-2 py-1 rounded text-xs font-bold">資料齊備</span></td>
                        </tr>
                        <tr class="hover:bg-slate-50">
                            <td class="px-6 py-4 font-bold text-slate-700">XYZ 物流中心</td>
                            <td class="px-6 py-4">2024</td>
                            <td class="px-6 py-4">2 / 6</td>
                            <td class="px-6 py-4 text-red-500">9-2, 9-3</td>
                            <td class="px-6 py-4"><span class="bg-red-100 text-red-800 px-2 py-1 rounded text-xs font-bold">未完成</span></td>
                        </tr>
                        <tr class="hover:bg-slate-50">
                            <td class="px-6 py-4 font-bold text-slate-700">TopTech 電子</td>
                            <td class="px-6 py-4">2024</td>
                            <td class="px-6 py-4">6 / 6</td>
                            <td class="px-6 py-4 text-green-500">無</td>
                            <td class="px-6 py-4"><span class="bg-emerald-100 text-emerald-800 px-2 py-1 rounded text-xs font-bold">資料齊備</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- ========================================== -->
        <!-- Tab 4: 文管機器人 -->
        <!-- ========================================== -->
        <div id="tab4" class="hidden">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 h-full">
                <!-- 左側：模擬上傳 -->
                <div class="bg-white p-6 rounded-lg shadow border border-slate-200 flex flex-col">
                    <h3 class="font-bold text-slate-700 mb-4 border-b pb-2">文件智能分類助手 (Demo)</h3>
                    <div class="flex-grow flex flex-col justify-center items-center border-2 border-dashed border-indigo-200 bg-indigo-50 rounded-lg p-8 cursor-pointer hover:bg-indigo-100 transition-colors" onclick="simulateDocAnalysis()">
                        <i class="fa-solid fa-file-import text-4xl text-indigo-400 mb-3"></i>
                        <p class="font-bold text-indigo-800">點擊此處模擬上傳文件</p>
                        <p class="text-xs text-indigo-500 mt-1">模擬檔案：SCAN_20250123_UNK.pdf</p>
                    </div>
                </div>

                <!-- 右側：分析結果 -->
                <div id="doc-result" class="bg-white p-6 rounded-lg shadow border border-slate-200 opacity-50 pointer-events-none transition-all duration-500">
                    <h3 class="font-bold text-slate-700 mb-4 border-b pb-2">AI 預判分類結果</h3>
                    <div class="space-y-4">
                        <div class="bg-yellow-50 border-l-4 border-yellow-400 p-3 text-xs text-yellow-800 mb-4">
                            <i class="fa-solid fa-triangle-exclamation mr-1"></i>
                            本結果由 AI 輔助推論，尚未寫入資料庫，請人工確認。
                        </div>
                        <div class="flex justify-between items-center border-b border-slate-100 pb-2">
                            <span class="text-slate-500 text-sm">推測事業單位</span>
                            <div class="flex items-center"><span class="font-bold text-slate-800">ABCDEF有限公司</span><span class="ml-2 text-[10px] bg-indigo-100 text-indigo-700 px-1 rounded">信心度 98%</span></div>
                        </div>
                        <div class="flex justify-between items-center border-b border-slate-100 pb-2">
                            <span class="text-slate-500 text-sm">推測年度</span>
                            <div class="flex items-center"><span class="font-bold text-slate-800">2024</span></div>
                        </div>
                        <div class="flex justify-between items-center border-b border-slate-100 pb-2">
                            <span class="text-slate-500 text-sm">推測歸檔類別</span>
                            <div class="flex items-center"><span class="font-bold text-slate-800">9-2 適性評估</span><span class="ml-2 text-[10px] bg-indigo-100 text-indigo-700 px-1 rounded">信心度 85%</span></div>
                        </div>
                    </div>
                    <div class="mt-8 flex space-x-3">
                        <button onclick="resetDocDemo()" class="flex-1 border border-slate-300 text-slate-600 px-4 py-2 rounded text-sm hover:bg-slate-50">重置</button>
                        <button onclick="alert('Demo: 已確認並歸檔')" class="flex-1 bg-indigo-600 text-white px-4 py-2 rounded text-sm font-bold hover:bg-indigo-700 shadow"><i class="fa-solid fa-check mr-2"></i>確認並歸檔</button>
                    </div>
                </div>
            </div>
        </div>

    </main>

    <!-- PDF Modal -->
    <div id="pdf-modal" class="fixed inset-0 bg-slate-900 bg-opacity-75 z-50 hidden flex items-center justify-center p-4 backdrop-blur-sm">
        <div class="bg-white w-full max-w-4xl h-[80vh] rounded-lg shadow-2xl flex flex-col overflow-hidden">
            <div class="bg-slate-800 text-white px-4 py-3 flex justify-between items-center shrink-0">
                <h3 class="font-bold text-sm" id="modal-title">文件預覽</h3>
                <button onclick="closePdfModal()" class="text-slate-400 hover:text-white"><i class="fa-solid fa-xmark text-lg"></i></button>
            </div>
            <div class="flex-grow bg-slate-100 flex flex-col items-center justify-center p-8">
                <i class="fa-regular fa-file-pdf text-6xl text-slate-300 mb-4"></i>
                <p class="text-slate-400 font-bold text-lg">PDF 文件預覽區 (Demo)</p>
            </div>
            <div class="bg-white border-t border-slate-200 p-3 text-right shrink-0">
                <button onclick="closePdfModal()" class="bg-slate-600 text-white px-4 py-2 rounded text-sm hover:bg-slate-700">關閉視窗</button>
            </div>
        </div>
    </div>

    <script>
        // Tab 切換
        function switchTab(tabId) {
            ['tab1', 'tab2', 'tab3', 'tab4'].forEach(id => {
                document.getElementById(id).classList.add('hidden');
                document.getElementById(id).classList.remove('h-full', 'flex', 'flex-col');
            });
            const target = document.getElementById(tabId);
            target.classList.remove('hidden');
            if(tabId === 'tab1' || tabId === 'tab4') target.classList.add('h-full', 'flex', 'flex-col');
            ['btn-tab1', 'btn-tab2', 'btn-tab3', 'btn-tab4'].forEach(btnId => {
                const btn = document.getElementById(btnId);
                if (btnId === 'btn-' + tabId) {
                    btn.classList.add('tab-active', 'border-slate-200');
                    btn.classList.remove('tab-inactive', 'border-transparent');
                } else {
                    btn.classList.remove('tab-active', 'border-slate-200');
                    btn.classList.add('tab-inactive', 'border-transparent');
                }
            });
        }

        // Tab 2: 帶入資料
        function fetchCompanyData() {
            const taxId = document.getElementById('input-tax-id').value.trim();
            if (taxId === '12345678') {
                const btn = event.currentTarget;
                const originalHtml = btn.innerHTML;
                btn.innerHTML = '<i class="fa-solid fa-spinner fa-spin mr-2"></i> 查詢中...';
                btn.disabled = true;
                setTimeout(() => {
                    document.getElementById('company-data-section').classList.remove('hidden');
                    document.getElementById('company-data-section').classList.add('fade-in-section');
                    btn.innerHTML = '<i class="fa-solid fa-check mr-2"></i> 資料已帶入';
                    btn.classList.replace('bg-blue-600', 'bg-emerald-600');
                    setTimeout(() => {
                         btn.disabled = false;
                         btn.innerHTML = originalHtml;
                         btn.classList.replace('bg-emerald-600', 'bg-blue-600');
                    }, 2000);
                }, 800);
            } else {
                alert('查無此統編資料 (Demo: 請輸入 12345678)');
            }
        }

        // Tab 2: 編輯模式切換
        let isEditMode = false;
        function toggleEditMode() {
            const btn = document.getElementById('edit-btn');
            const fields = document.querySelectorAll('.data-field');
            isEditMode = !isEditMode;
            if (isEditMode) {
                fields.forEach(field => {
                    field.readOnly = false;
                    field.classList.remove('input-readonly');
                    field.classList.add('input-editable');
                });
                btn.innerHTML = '<i class="fa-solid fa-save mr-2"></i> 儲存變更';
                btn.classList.remove('bg-white', 'text-slate-700', 'border-slate-300');
                btn.classList.add('bg-blue-600', 'text-white', 'border-blue-600', 'hover:bg-blue-700');
            } else {
                fields.forEach(field => {
                    field.readOnly = true;
                    field.classList.remove('input-editable');
                    field.classList.add('input-readonly');
                });
                btn.innerHTML = '<i class="fa-solid fa-pen-to-square mr-2"></i> 資料更新 (啟用編輯)';
                btn.classList.add('bg-white', 'text-slate-700', 'border-slate-300');
                btn.classList.remove('bg-blue-600', 'text-white', 'border-blue-600', 'hover:bg-blue-700');
                alert('系統訊息：資料已更新並暫存。');
            }
        }

        // Tab 1: 搜尋
        function performSearch() {
            const input = document.getElementById('search-input');
            if(input.value.trim() === "") return;
            document.getElementById('search-view').classList.add('hidden');
            document.getElementById('search-view').classList.remove('flex');
            document.getElementById('report-view').classList.remove('hidden');
        }
        function resetSearch() {
            document.getElementById('report-view').classList.add('hidden');
            document.getElementById('search-view').classList.remove('hidden');
            document.getElementById('search-view').classList.add('flex');
        }

        // Tab 4: 文管機器人 Demo
        function simulateDocAnalysis() {
            const resultDiv = document.getElementById('doc-result');
            resultDiv.style.opacity = '0.7';
            document.body.style.cursor = 'wait';
            setTimeout(() => {
                resultDiv.classList.remove('opacity-50', 'pointer-events-none');
                resultDiv.classList.add('opacity-100');
                resultDiv.style.opacity = '1';
                document.body.style.cursor = 'default';
            }, 800);
        }
        function resetDocDemo() {
            const resultDiv = document.getElementById('doc-result');
            resultDiv.classList.add('opacity-50', 'pointer-events-none');
            resultDiv.classList.remove('opacity-100');
        }

        // PDF Modal
        function openPdfModal(filename) {
            document.getElementById('modal-title').innerText = "預覽：" + filename;
            document.getElementById('pdf-modal').classList.remove('hidden');
        }
        function closePdfModal() {
            document.getElementById('pdf-modal').classList.add('hidden');
        }

        // Init
        document.addEventListener('DOMContentLoaded', () => {
            switchTab('tab1');
        });
    </script>
</body>
</html>
